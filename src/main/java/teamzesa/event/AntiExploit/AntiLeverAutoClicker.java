package teamzesa.event.AntiExploit;

import org.bukkit.Material;
import org.bukkit.block.Block;
import org.bukkit.entity.Player;
import org.bukkit.event.block.Action;
import org.bukkit.event.player.PlayerInteractEvent;
import teamzesa.event.register.EventRegister;
import teamzesa.util.ComponentExchanger;

public class AntiLeverAutoClicker extends ComponentExchanger implements EventRegister {
    private static long oldClickLever;
    private static long currentClickLever;
    private Player player;
    private Action action;
    private Block clickedBlock;
    private final PlayerInteractEvent event;

    public AntiLeverAutoClicker(PlayerInteractEvent event) {
        this.event = event;
        init();
        execute();
    }

    @Override
    public void init() {
        currentClickLever = System.currentTimeMillis();
        this.player = this.event.getPlayer();
        this.action = this.event.getAction();
        this.clickedBlock = this.event.getClickedBlock();
    }

    @Override
    public void execute() {
        System.out.println();
        System.out.println("1");
//        클릭블럭 체크
        if (this.clickedBlock == null) return;

        System.out.println("2");
//        블럭타입체크 * 로직상 우선되어야 더빠른 처리
        if (this.clickedBlock.getType() != Material.LEVER) return;

        System.out.println("3");
//        우클릭인지 확인
        if (!(this.action.isRightClick())) return;

        System.out.println("4");

        /*int delay = 0;
        int interval = 1;
        ThreadPool.getThreadPool().addSchedulingTaskSec(
                () -> {
                    this.allowClickLever = true;
                    System.out.println(this.allowClickLever);
                },
                delay,
                interval
        );*/
    }
}
